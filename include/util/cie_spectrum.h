#ifndef CIE_SPECTRUM_H
#define CIE_SPECTRUM_H

// CIE XYZ to sRGB matrix
// https://stackoverflow.com/q/66360637
const float3 CIE_XYZ_TO_SRGB[3] = {
    make_float3(3.2404542f, -1.5371385f, -0.4985314f),
    make_float3(-0.9692660f, 1.8760108f,  0.0415560f),
    make_float3(0.0556434f, -0.2040259f,  1.0572252f),
};

// CIE color matching functions
const float3 CIE_COLOR_MATCHING_FUNCTIONS[301] = {
    make_float3(0.014310000f, 0.000396000f, 0.067850010f),
    make_float3(0.015704430f, 0.000433715f, 0.074486320f),
    make_float3(0.017147440f, 0.000473024f, 0.081361560f),
    make_float3(0.018781220f, 0.000517876f, 0.089153640f),
    make_float3(0.020748010f, 0.000572219f, 0.098540480f),
    make_float3(0.023190000f, 0.000640000f, 0.110200000f),
    make_float3(0.026207360f, 0.000724560f, 0.124613300f),
    make_float3(0.029782480f, 0.000825500f, 0.141701700f),
    make_float3(0.033880920f, 0.000941160f, 0.161303500f),
    make_float3(0.038468240f, 0.001069880f, 0.183256800f),
    make_float3(0.043510000f, 0.001210000f, 0.207400000f),
    make_float3(0.048995600f, 0.001362091f, 0.233692100f),
    make_float3(0.055022600f, 0.001530752f, 0.262611400f),
    make_float3(0.061718800f, 0.001720368f, 0.294774600f),
    make_float3(0.069212000f, 0.001935323f, 0.330798500f),
    make_float3(0.077630000f, 0.002180000f, 0.371300000f),
    make_float3(0.086958110f, 0.002454800f, 0.416209100f),
    make_float3(0.097176720f, 0.002764000f, 0.465464200f),
    make_float3(0.108406300f, 0.003117800f, 0.519694800f),
    make_float3(0.120767200f, 0.003526400f, 0.579530300f),
    make_float3(0.134380000f, 0.004000000f, 0.645600000f),
    make_float3(0.149358200f, 0.004546240f, 0.718483800f),
    make_float3(0.165395700f, 0.005159320f, 0.796713300f),
    make_float3(0.181983100f, 0.005829280f, 0.877845900f),
    make_float3(0.198611000f, 0.006546160f, 0.959439000f),
    make_float3(0.214770000f, 0.007300000f, 1.039050100f),
    make_float3(0.230186800f, 0.008086507f, 1.115367300f),
    make_float3(0.244879700f, 0.008908720f, 1.188497100f),
    make_float3(0.258777300f, 0.009767680f, 1.258123300f),
    make_float3(0.271807900f, 0.010664430f, 1.323929600f),
    make_float3(0.283900000f, 0.011600000f, 1.385600000f),
    make_float3(0.294943800f, 0.012573170f, 1.442635200f),
    make_float3(0.304896500f, 0.013582720f, 1.494803500f),
    make_float3(0.313787300f, 0.014629680f, 1.542190300f),
    make_float3(0.321645400f, 0.015715090f, 1.584880700f),
    make_float3(0.328500000f, 0.016840000f, 1.622960000f),
    make_float3(0.334351300f, 0.018007360f, 1.656404800f),
    make_float3(0.339210100f, 0.019214480f, 1.685295900f),
    make_float3(0.343121300f, 0.020453920f, 1.709874500f),
    make_float3(0.346129600f, 0.021718240f, 1.730382100f),
    make_float3(0.348280000f, 0.023000000f, 1.747060000f),
    make_float3(0.349599900f, 0.024294610f, 1.760044600f),
    make_float3(0.350147400f, 0.025610240f, 1.769623300f),
    make_float3(0.350013000f, 0.026958570f, 1.776263700f),
    make_float3(0.349287000f, 0.028351250f, 1.780433400f),
    make_float3(0.348060000f, 0.029800000f, 1.782600000f),
    make_float3(0.346373300f, 0.031310830f, 1.782968200f),
    make_float3(0.344262400f, 0.032883680f, 1.781699800f),
    make_float3(0.341808800f, 0.034521120f, 1.779198200f),
    make_float3(0.339094100f, 0.036225710f, 1.775867100f),
    make_float3(0.336200000f, 0.038000000f, 1.772110000f),
    make_float3(0.333197700f, 0.039846670f, 1.768258900f),
    make_float3(0.330041100f, 0.041768000f, 1.764039000f),
    make_float3(0.326635700f, 0.043766000f, 1.758943800f),
    make_float3(0.322886800f, 0.045842670f, 1.752466300f),
    make_float3(0.318700000f, 0.048000000f, 1.744100000f),
    make_float3(0.314025100f, 0.050243680f, 1.733559500f),
    make_float3(0.308884000f, 0.052573040f, 1.720858100f),
    make_float3(0.303290400f, 0.054980560f, 1.705936900f),
    make_float3(0.297257900f, 0.057458720f, 1.688737200f),
    make_float3(0.290800000f, 0.060000000f, 1.669200000f),
    make_float3(0.283970100f, 0.062601970f, 1.647528700f),
    make_float3(0.276721400f, 0.065277520f, 1.623412700f),
    make_float3(0.268917800f, 0.068042080f, 1.596022300f),
    make_float3(0.260422700f, 0.070911090f, 1.564528000f),
    make_float3(0.251100000f, 0.073900000f, 1.528100000f),
    make_float3(0.240847500f, 0.077016000f, 1.486111400f),
    make_float3(0.229851200f, 0.080266400f, 1.439521500f),
    make_float3(0.218407200f, 0.083666800f, 1.389879900f),
    make_float3(0.206811500f, 0.087232800f, 1.338736200f),
    make_float3(0.195360000f, 0.090980000f, 1.287640000f),
    make_float3(0.184213600f, 0.094917550f, 1.237422300f),
    make_float3(0.173327300f, 0.099045840f, 1.187824300f),
    make_float3(0.162688100f, 0.103367400f, 1.138761100f),
    make_float3(0.152283300f, 0.107884600f, 1.090148000f),
    make_float3(0.142100000f, 0.112600000f, 1.041900000f),
    make_float3(0.132178600f, 0.117532000f, 0.994197600f),
    make_float3(0.122569600f, 0.122674400f, 0.947347300f),
    make_float3(0.113275200f, 0.127992800f, 0.901453100f),
    make_float3(0.104297900f, 0.133452800f, 0.856619300f),
    make_float3(0.095640000f, 0.139020000f, 0.812950100f),
    make_float3(0.087299550f, 0.144676400f, 0.770517300f),
    make_float3(0.079308040f, 0.150469300f, 0.729444800f),
    make_float3(0.071717760f, 0.156461900f, 0.689913600f),
    make_float3(0.064580990f, 0.162717700f, 0.652104900f),
    make_float3(0.057950010f, 0.169300000f, 0.616200000f),
    make_float3(0.051862110f, 0.176243100f, 0.582328600f),
    make_float3(0.046281520f, 0.183558100f, 0.550416200f),
    make_float3(0.041150880f, 0.191273500f, 0.520337600f),
    make_float3(0.036412830f, 0.199418000f, 0.491967300f),
    make_float3(0.032010000f, 0.208020000f, 0.465180000f),
    make_float3(0.027917200f, 0.217119900f, 0.439924600f),
    make_float3(0.024144400f, 0.226734500f, 0.416183600f),
    make_float3(0.020687000f, 0.236857100f, 0.393882200f),
    make_float3(0.017540400f, 0.247481200f, 0.372945900f),
    make_float3(0.014700000f, 0.258600000f, 0.353300000f),
    make_float3(0.012161790f, 0.270184900f, 0.334857800f),
    make_float3(0.009919960f, 0.282293900f, 0.317552100f),
    make_float3(0.007967240f, 0.295050500f, 0.301337500f),
    make_float3(0.006296346f, 0.308578000f, 0.286168600f),
    make_float3(0.004900000f, 0.323000000f, 0.272000000f),
    make_float3(0.003777173f, 0.338402100f, 0.258817100f),
    make_float3(0.002945320f, 0.354685800f, 0.246483800f),
    make_float3(0.002424880f, 0.371698600f, 0.234771800f),
    make_float3(0.002236293f, 0.389287500f, 0.223453300f),
    make_float3(0.002400000f, 0.407300000f, 0.212300000f),
    make_float3(0.002925520f, 0.425629900f, 0.201169200f),
    make_float3(0.003836560f, 0.444309600f, 0.190119600f),
    make_float3(0.005174840f, 0.463394400f, 0.179225400f),
    make_float3(0.006982080f, 0.482939500f, 0.168560800f),
    make_float3(0.009300000f, 0.503000000f, 0.158200000f),
    make_float3(0.012149490f, 0.523569300f, 0.148138300f),
    make_float3(0.015535880f, 0.544512000f, 0.138375800f),
    make_float3(0.019477520f, 0.565690000f, 0.128994200f),
    make_float3(0.023992770f, 0.586965300f, 0.120075100f),
    make_float3(0.029100000f, 0.608200000f, 0.111700000f),
    make_float3(0.034814850f, 0.629345600f, 0.103904800f),
    make_float3(0.041120160f, 0.650306800f, 0.096667480f),
    make_float3(0.047985040f, 0.670875200f, 0.089982720f),
    make_float3(0.055378610f, 0.690842400f, 0.083845310f),
    make_float3(0.063270000f, 0.710000000f, 0.078249990f),
    make_float3(0.071635010f, 0.728185200f, 0.073208990f),
    make_float3(0.080462240f, 0.745463600f, 0.068678160f),
    make_float3(0.089739960f, 0.761969400f, 0.064567840f),
    make_float3(0.099456450f, 0.777836800f, 0.060788350f),
    make_float3(0.109600000f, 0.793200000f, 0.057250010f),
    make_float3(0.120167400f, 0.808110400f, 0.053904350f),
    make_float3(0.131114500f, 0.822496200f, 0.050746640f),
    make_float3(0.142367900f, 0.836306800f, 0.047752760f),
    make_float3(0.153854200f, 0.849491600f, 0.044898590f),
    make_float3(0.165500000f, 0.862000000f, 0.042160000f),
    make_float3(0.177257100f, 0.873810800f, 0.039507280f),
    make_float3(0.189140000f, 0.884962400f, 0.036935640f),
    make_float3(0.201169400f, 0.895493600f, 0.034458360f),
    make_float3(0.213365800f, 0.905443200f, 0.032088720f),
    make_float3(0.225749900f, 0.914850100f, 0.029840000f),
    make_float3(0.238320900f, 0.923734800f, 0.027711810f),
    make_float3(0.251066800f, 0.932092400f, 0.025694440f),
    make_float3(0.263992200f, 0.939922600f, 0.023787160f),
    make_float3(0.277101700f, 0.947225200f, 0.021989250f),
    make_float3(0.290400000f, 0.954000000f, 0.020300000f),
    make_float3(0.303891200f, 0.960256100f, 0.018718050f),
    make_float3(0.317572600f, 0.966007400f, 0.017240360f),
    make_float3(0.331438400f, 0.971260600f, 0.015863640f),
    make_float3(0.345482800f, 0.976022500f, 0.014584610f),
    make_float3(0.359700000f, 0.980300000f, 0.013400000f),
    make_float3(0.374083900f, 0.984092400f, 0.012307230f),
    make_float3(0.388639600f, 0.987418200f, 0.011301880f),
    make_float3(0.403378400f, 0.990312800f, 0.010377920f),
    make_float3(0.418311500f, 0.992811600f, 0.009529306f),
    make_float3(0.433449900f, 0.994950100f, 0.008749999f),
    make_float3(0.448795300f, 0.996710800f, 0.008035200f),
    make_float3(0.464336000f, 0.998098300f, 0.007381600f),
    make_float3(0.480064000f, 0.999112000f, 0.006785400f),
    make_float3(0.495971300f, 0.999748200f, 0.006242800f),
    make_float3(0.512050100f, 1.000000000f, 0.005749999f),
    make_float3(0.528295900f, 0.999856700f, 0.005303600f),
    make_float3(0.544691600f, 0.999304600f, 0.004899800f),
    make_float3(0.561209400f, 0.998325500f, 0.004534200f),
    make_float3(0.577821500f, 0.996898700f, 0.004202400f),
    make_float3(0.594500000f, 0.995000000f, 0.003900000f),
    make_float3(0.611220900f, 0.992600500f, 0.003623200f),
    make_float3(0.627975800f, 0.989742600f, 0.003370600f),
    make_float3(0.644760200f, 0.986444400f, 0.003141400f),
    make_float3(0.661569700f, 0.982724100f, 0.002934800f),
    make_float3(0.678400000f, 0.978600000f, 0.002749999f),
    make_float3(0.695239200f, 0.974083700f, 0.002585200f),
    make_float3(0.712058600f, 0.969171200f, 0.002438600f),
    make_float3(0.728828400f, 0.963856800f, 0.002309400f),
    make_float3(0.745518800f, 0.958134900f, 0.002196800f),
    make_float3(0.762100000f, 0.952000000f, 0.002100000f),
    make_float3(0.778543200f, 0.945450400f, 0.002017733f),
    make_float3(0.794825600f, 0.938499200f, 0.001948200f),
    make_float3(0.810926400f, 0.931162800f, 0.001889800f),
    make_float3(0.826824800f, 0.923457600f, 0.001840933f),
    make_float3(0.842500000f, 0.915400000f, 0.001800000f),
    make_float3(0.857932500f, 0.907006400f, 0.001766267f),
    make_float3(0.873081600f, 0.898277200f, 0.001737800f),
    make_float3(0.887894400f, 0.889204800f, 0.001711200f),
    make_float3(0.902318100f, 0.879781600f, 0.001683067f),
    make_float3(0.916300000f, 0.870000000f, 0.001650001f),
    make_float3(0.929799500f, 0.859861300f, 0.001610133f),
    make_float3(0.942798400f, 0.849392000f, 0.001564400f),
    make_float3(0.955277600f, 0.838622000f, 0.001513600f),
    make_float3(0.967217900f, 0.827581300f, 0.001458533f),
    make_float3(0.978600000f, 0.816300000f, 0.001400000f),
    make_float3(0.989385600f, 0.804794700f, 0.001336667f),
    make_float3(0.999548800f, 0.793082000f, 0.001270000f),
    make_float3(1.009089200f, 0.781192000f, 0.001205000f),
    make_float3(1.018006400f, 0.769154700f, 0.001146667f),
    make_float3(1.026300000f, 0.757000000f, 0.001100000f),
    make_float3(1.033982700f, 0.744754100f, 0.001068800f),
    make_float3(1.040986000f, 0.732422400f, 0.001049400f),
    make_float3(1.047188000f, 0.720003600f, 0.001035600f),
    make_float3(1.052466700f, 0.707496500f, 0.001021200f),
    make_float3(1.056700000f, 0.694900000f, 0.001000000f),
    make_float3(1.059794400f, 0.682219200f, 0.000968640f),
    make_float3(1.061799200f, 0.669471600f, 0.000929920f),
    make_float3(1.062806800f, 0.656674400f, 0.000886880f),
    make_float3(1.062909600f, 0.643844800f, 0.000842560f),
    make_float3(1.062200000f, 0.631000000f, 0.000800000f),
    make_float3(1.060735200f, 0.618155500f, 0.000760960f),
    make_float3(1.058443600f, 0.605314400f, 0.000723680f),
    make_float3(1.055224400f, 0.592475600f, 0.000685920f),
    make_float3(1.050976800f, 0.579637900f, 0.000645440f),
    make_float3(1.045600000f, 0.566800000f, 0.000600000f),
    make_float3(1.039036900f, 0.553961100f, 0.000547867f),
    make_float3(1.031360800f, 0.541137200f, 0.000491600f),
    make_float3(1.022666200f, 0.528352800f, 0.000435400f),
    make_float3(1.013047700f, 0.515632300f, 0.000383467f),
    make_float3(1.002600000f, 0.503000000f, 0.000340000f),
    make_float3(0.991367500f, 0.490468800f, 0.000307253f),
    make_float3(0.979331400f, 0.478030400f, 0.000283160f),
    make_float3(0.966491600f, 0.465677600f, 0.000265440f),
    make_float3(0.952847900f, 0.453403200f, 0.000251813f),
    make_float3(0.938400000f, 0.441200000f, 0.000240000f),
    make_float3(0.923194000f, 0.429080000f, 0.000229547f),
    make_float3(0.907244000f, 0.417036000f, 0.000220640f),
    make_float3(0.890502000f, 0.405032000f, 0.000211960f),
    make_float3(0.872920000f, 0.393032000f, 0.000202187f),
    make_float3(0.854449900f, 0.381000000f, 0.000190000f),
    make_float3(0.835084000f, 0.368918400f, 0.000174213f),
    make_float3(0.814946000f, 0.356827200f, 0.000155640f),
    make_float3(0.794186000f, 0.344776800f, 0.000135960f),
    make_float3(0.772954000f, 0.332817600f, 0.000116853f),
    make_float3(0.751400000f, 0.321000000f, 0.000100000f),
    make_float3(0.729583600f, 0.309338100f, 0.000086133f),
    make_float3(0.707588800f, 0.297850400f, 0.000074600f),
    make_float3(0.685602200f, 0.286593600f, 0.000065000f),
    make_float3(0.663810400f, 0.275624500f, 0.000056933f),
    make_float3(0.642400000f, 0.265000000f, 0.000050000f),
    make_float3(0.621514900f, 0.254763200f, 0.000044160f),
    make_float3(0.601113800f, 0.244889600f, 0.000039480f),
    make_float3(0.581105200f, 0.235334400f, 0.000035720f),
    make_float3(0.561397700f, 0.226052800f, 0.000032640f),
    make_float3(0.541900000f, 0.217000000f, 0.000030000f),
    make_float3(0.522599500f, 0.208161600f, 0.000027653f),
    make_float3(0.503546400f, 0.199548800f, 0.000025560f),
    make_float3(0.484743600f, 0.191155200f, 0.000023640f),
    make_float3(0.466193900f, 0.182974400f, 0.000021813f),
    make_float3(0.447900000f, 0.175000000f, 0.000020000f),
    make_float3(0.429861300f, 0.167223500f, 0.000018133f),
    make_float3(0.412098000f, 0.159646400f, 0.000016200f),
    make_float3(0.394644000f, 0.152277600f, 0.000014200f),
    make_float3(0.377533300f, 0.145125900f, 0.000012133f),
    make_float3(0.360800000f, 0.138200000f, 0.000010000f),
    make_float3(0.344456300f, 0.131500300f, 0.000007733f),
    make_float3(0.328516800f, 0.125024800f, 0.000005400f),
    make_float3(0.313019200f, 0.118779200f, 0.000003200f),
    make_float3(0.298001100f, 0.112769100f, 0.000001333f),
    make_float3(0.283500000f, 0.107000000f, 0.000000000f),
    make_float3(0.269544800f, 0.101476200f, 0.000000000f),
    make_float3(0.256118400f, 0.096188640f, 0.000000000f),
    make_float3(0.243189600f, 0.091122960f, 0.000000000f),
    make_float3(0.230727200f, 0.086264850f, 0.000000000f),
    make_float3(0.218700000f, 0.081600000f, 0.000000000f),
    make_float3(0.207097100f, 0.077120640f, 0.000000000f),
    make_float3(0.195923200f, 0.072825520f, 0.000000000f),
    make_float3(0.185170800f, 0.068710080f, 0.000000000f),
    make_float3(0.174832300f, 0.064769760f, 0.000000000f),
    make_float3(0.164900000f, 0.061000000f, 0.000000000f),
    make_float3(0.155366700f, 0.057396210f, 0.000000000f),
    make_float3(0.146230000f, 0.053955040f, 0.000000000f),
    make_float3(0.137490000f, 0.050673760f, 0.000000000f),
    make_float3(0.129146700f, 0.047549650f, 0.000000000f),
    make_float3(0.121200000f, 0.044580000f, 0.000000000f),
    make_float3(0.113639700f, 0.041758720f, 0.000000000f),
    make_float3(0.106465000f, 0.039084960f, 0.000000000f),
    make_float3(0.099690440f, 0.036563840f, 0.000000000f),
    make_float3(0.093330610f, 0.034200480f, 0.000000000f),
    make_float3(0.087400000f, 0.032000000f, 0.000000000f),
    make_float3(0.081900960f, 0.029962610f, 0.000000000f),
    make_float3(0.076804280f, 0.028076640f, 0.000000000f),
    make_float3(0.072077120f, 0.026329360f, 0.000000000f),
    make_float3(0.067686640f, 0.024708050f, 0.000000000f),
    make_float3(0.063600000f, 0.023200000f, 0.000000000f),
    make_float3(0.059806850f, 0.021800770f, 0.000000000f),
    make_float3(0.056282160f, 0.020501120f, 0.000000000f),
    make_float3(0.052971040f, 0.019281080f, 0.000000000f),
    make_float3(0.049818610f, 0.018120690f, 0.000000000f),
    make_float3(0.046770000f, 0.017000000f, 0.000000000f),
    make_float3(0.043784050f, 0.015903790f, 0.000000000f),
    make_float3(0.040875360f, 0.014837180f, 0.000000000f),
    make_float3(0.038072640f, 0.013810680f, 0.000000000f),
    make_float3(0.035404610f, 0.012834780f, 0.000000000f),
    make_float3(0.032900000f, 0.011920000f, 0.000000000f),
    make_float3(0.030564190f, 0.011068310f, 0.000000000f),
    make_float3(0.028380560f, 0.010273390f, 0.000000000f),
    make_float3(0.026344840f, 0.009533311f, 0.000000000f),
    make_float3(0.024452750f, 0.008846157f, 0.000000000f),
    make_float3(0.022700000f, 0.008210000f, 0.000000000f),
    make_float3(0.021084290f, 0.007623781f, 0.000000000f),
    make_float3(0.019599880f, 0.007085424f, 0.000000000f),
    make_float3(0.018237320f, 0.006591476f, 0.000000000f),
    make_float3(0.016987170f, 0.006138485f, 0.000000000f),
    make_float3(0.015840000f, 0.005723000f, 0.000000000f),
    make_float3(0.014790640f, 0.005343059f, 0.000000000f),
    make_float3(0.013831320f, 0.004995796f, 0.000000000f),
    make_float3(0.012948680f, 0.004676404f, 0.000000000f),
    make_float3(0.012129200f, 0.004380075f, 0.000000000f),
    make_float3(0.011359160f, 0.004102000f, 0.000000000f)
};

#endif // CIE_SPECTRUM_H